<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Custom component highlight bookmarklet | DreamOnward</title>
  <meta name="description" content="A good way to get a feel for a web application is to first figure out the component hierarchy. To aid in understanding the component structure we will create...">

  <link href="https://fonts.googleapis.com/css?family=Roboto|Roboto+Condensed" rel="stylesheet">

  <link type="text/css" rel="stylesheet" href="/assets/main-f021d588a416e00beed710bc60b3e7d8ac016a8d0eb7a5f17faa05cb145c27b4.css">
  <link type="text/css" rel="stylesheet" href="/assets/syntax-pygments-306491d01ec67c312c7391230abbf00e22dbdb2a9c283cb4cf00dc270ce28162.css">
  <link href="/assets/vendor/lightbox/css/lightbox.min.css" rel="stylesheet">
  <link rel="canonical" href="https://dreamonward.com/2017/04/25/custom-component-highlight-bookmarklet/">
</head>


  <body>
    <header class="banner" role="banner">
  <nav class="container site-nav">

    <a class="site-logo-space" href="/">
      <div class="site-logo">
        <img src="/assets/img/DreamOnward_logo_v1-800x800.png" height="60" srcset="/assets/img/DreamOnward_logo_v1-800x800.png 1x, /assets/img/DreamOnward_logo_v1-800x800.png 2x, /assets/img/DreamOnward_logo_v1-800x800.png 3x"> 
      </div>
      <div class="site-header-titles">
        <h1 class="site-header-title">DreamOnward</h1>
        <span class="site-header-subtitle">Full stack web development</span>
      </div>
    </a>

    <ul>
      
        
        <li>
          <a href="/projects">Projects</a>
        </li>
        
      
    </ul>
  </nav>


</header>


    <main class="page-content" aria-label="Content">
    <article class="post container" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Custom component highlight bookmarklet</h1>
    <p class="post-meta">
    	<time datetime="2017-04-25T00:00:00+00:00" itemprop="datePublished">Apr 25, 2017</time>
	</p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>A good way to get a feel for a web application is to first figure out the component hierarchy.
To aid in understanding the component structure we will create a simple bookmarklet that highlights custom components.</p>

<p>Understanding an App is easier once you have a mental map how pages are structured.
Because it shows how the (hopefully) flat component structure and actual components work together.
We’ll look how we can identify app components structure by adding some custom styling to all none standard HTML tags using a bookmarklet.</p>

<p>The end result is a bookmarklet that shows all components on the current page:</p>

<figure>
<img src="/2017/04/25/custom-component-highlight-bookmarklet/angular-component-highlight.gif" alt="Custom web components highlighted in Angular heroes example page" />
<figcaption>Custom web components highlighted in Angular heroes example page</figcaption>
</figure>

<p><a href="#result">Try it out yourself</a> or read on to see how it works.</p>

<h2 id="highlight-app-component-html-tags">Highlight app component HTML tags</h2>

<p>The goal is to quickly see how a web app is composed by showing all web components.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;body&gt;
	&lt;my-app&gt;
		&lt;div&gt;
			&lt;my-list&gt;
				&lt;my-item&gt;&lt;/my-item&gt;
				&lt;my-item&gt;&lt;/my-item&gt;
			&lt;/my-list&gt;
		&lt;/div&gt;
	&lt;/my-app&gt;
&lt;/body&gt;
</code></pre>
</div>

<p>Say you have the basic application structure from above.
We will look how we can determine and style the <code class="highlighter-rouge">my-app</code>, <code class="highlighter-rouge">my-list</code> and <code class="highlighter-rouge">my-item</code> components so you can easily identify them as a developer.</p>

<p>In order to use the technique as widely as possible we will look at a library agnostic solution.
That means we can’t hook into the your view library of choice to determine all components.
We are stuck with what we can gather from the DOM.
Luckily we can do this because custom components should not overlap with any standard HTML tags.
So we can just select all none standard tags.</p>

<p>This approach means that:</p>

<ul>
  <li>Only components that have custom HTML tags in the final page are shown, so Angular components are selected, React components are not.</li>
  <li>We have an admittedly hacky approach to do this, but hey, as long as it works, right :).</li>
</ul>

<h2 id="selecting-components">Selecting components</h2>

<p>The first step in showing new HTML tags is finding them on the current page.
Luckily these custom elements have one very clear property, they are not a standard HTML tag.</p>

<p>A quick look at <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element">MDN</a> yields the following list:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>knownTags = ['address', 'article', 'aside', 'footer', 'h1','h2','h3','h4','h5','h6', 'header', 'hgroup', 'nav', 'section', 'dd', 'div', 'dl', 'dt', 'figcaption', 'figure', 'hr', 'li', 'main', 'ol', 'p', 'pre', 'ul', 'a', 'abbr', 'b', 'bdi', 'bdo', 'br', 'cite', 'code', 'data', 'dfn', 'em', 'i', 'kbd', 'mark', 'q', 'rp', 'rt', 'rtc', 'ruby', 's', 'samp', 'small', 'span', 'strong', 'sub', 'sup', 'time', 'u', 'var', 'wbr','caption', 'col', 'colgroup', 'table', 'tbody', 'td', 'tfoot', 'th', 'thead', 'tr', 'button', 'datalist', 'fieldset', 'form', 'input', 'label', 'legend', 'meter', 'optgroup', 'option', 'output', 'progress', 'select', 'textarea' ]
</code></pre>
</div>

<p>We want to select all elements that do not have these tags.
For that we can use the CSS not selector like:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>:not( address ):not( article ) ...
</code></pre>
</div>

<p>We create the selector and find nodes using:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>notCss = knownTags.map(tag =&gt; `:not( ${ tag } )`).join('')
nodes = document.querySelectorAll(`body ${ notCss }`)
</code></pre>
</div>

<p>The actual full CSS selector is very long:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>:not( address ):not( article ):not( aside ):not( footer ):not( h1 ):not( h2 ):not( h3 ):not( h4 ):not( h5 ):not( h6 ):not( header ):not( hgroup ):not( nav ):not( section ):not( dd ):not( div ):not( dl ):not( dt ):not( figcaption ):not( figure ):not( hr ):not( li ):not( main ):not( ol ):not( p ):not( pre ):not( ul ):not( a ):not( abbr ):not( b ):not( bdi ):not( bdo ):not( br ):not( cite ):not( code ):not( data ):not( dfn ):not( em ):not( i ):not( kbd ):not( mark ):not( q ):not( rp ):not( rt ):not( rtc ):not( ruby ):not( s ):not( samp ):not( small ):not( span ):not( strong ):not( sub ):not( sup ):not( time ):not( u ):not( var ):not( wbr ):not( caption ):not( col ):not( colgroup ):not( table ):not( tbody ):not( td ):not( tfoot ):not( th ):not( thead ):not( tr ):not( button ):not( datalist ):not( fieldset ):not( form ):not( input ):not( label ):not( legend ):not( meter ):not( optgroup ):not( option ):not( output ):not( progress ):not( select ):not( textarea )
</code></pre>
</div>

<p>Next up is actually highlighting these non standard elements in the DOM.</p>

<h2 id="highlighting">Highlighting</h2>

<p>To highlight the list of DOM nodes we’ll append a absolute positioned styled element.
Nothing to fancy.</p>

<p>One thing of note is using adding the CSS to the first style sheet we encounter.
Of course we could also inline the CSS, but this just seemed a bit nicer.</p>

<p>The result is as follows:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>nodesArray.map( node =&gt; {
  const outer = document.createElement('div');
  outer.className='debug-wrapper';
  const inner = document.createElement('div');
  inner.innerHTML = node.nodeName.toLowerCase();
  inner.className='debug-component';

  node.prepend(outer);
  outer.appendChild(inner);
});

const rules = [`
.debug-wrapper {
    position: relative;
}`,`
.debug-component {
    position: absolute;
    right: 0;
    z-index: 777;
    color: lightgray;
    font-size: 8px;
}`,`
.debug-component:hover {
    color: black;
    background-color: lightgray;
    font-size: 12px;
    padding: 0.2em;
}`];

const sheet = window.document.styleSheets[0];
rules.map(rule =&gt; sheet.insertRule(rule, sheet.cssRules &amp;&amp; sheet.cssRules.length || 0) ); 
</code></pre>
</div>

<p>For the complete code see the <a href="https://github.com/RRMoelker/component-highlight-bookmarklet">GitHub project</a>.</p>

<h2 id="creating-a-bookmarklet">Creating a bookmarklet</h2>

<p>Now one way to apply this code to the current page is to drop in in the browser console.
That however is a bit tedious, so let us look another deployment method: a bookmarklet.</p>

<p>Creating a bookmarklet is surprisingly simple.
Stupidly simple actually.
You just dump your entire script inside an anchor tag like:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"javascript:&lt;my-custom-code&gt;"</span><span class="nt">&gt;</span>My custom code is executed if dragged to bookmarks list and pressed<span class="nt">&lt;/a&gt;</span></code></pre></figure>

<h2 id="result">Highlighting bookmark</h2>

<p>Applying the custom tag highlighting code to a bookmarklet yields us the following link:</p>

<p><a href="javascript:&#x27;use strict&#x27;;(function(){var knownTags=[&#x27;address&#x27;,&#x27;article&#x27;,&#x27;aside&#x27;,&#x27;footer&#x27;,&#x27;h1&#x27;,&#x27;h2&#x27;,&#x27;h3&#x27;,&#x27;h4&#x27;,&#x27;h5&#x27;,&#x27;h6&#x27;,&#x27;header&#x27;,&#x27;hgroup&#x27;,&#x27;nav&#x27;,&#x27;section&#x27;,&#x27;dd&#x27;,&#x27;div&#x27;,&#x27;dl&#x27;,&#x27;dt&#x27;,&#x27;figcaption&#x27;,&#x27;figure&#x27;,&#x27;hr&#x27;,&#x27;li&#x27;,&#x27;main&#x27;,&#x27;ol&#x27;,&#x27;p&#x27;,&#x27;pre&#x27;,&#x27;ul&#x27;,&#x27;a&#x27;,&#x27;abbr&#x27;,&#x27;b&#x27;,&#x27;bdi&#x27;,&#x27;bdo&#x27;,&#x27;br&#x27;,&#x27;cite&#x27;,&#x27;code&#x27;,&#x27;data&#x27;,&#x27;dfn&#x27;,&#x27;em&#x27;,&#x27;i&#x27;,&#x27;kbd&#x27;,&#x27;mark&#x27;,&#x27;q&#x27;,&#x27;rp&#x27;,&#x27;rt&#x27;,&#x27;rtc&#x27;,&#x27;ruby&#x27;,&#x27;s&#x27;,&#x27;samp&#x27;,&#x27;small&#x27;,&#x27;span&#x27;,&#x27;strong&#x27;,&#x27;sub&#x27;,&#x27;sup&#x27;,&#x27;time&#x27;,&#x27;u&#x27;,&#x27;var&#x27;,&#x27;wbr&#x27;,&#x27;caption&#x27;,&#x27;col&#x27;,&#x27;colgroup&#x27;,&#x27;table&#x27;,&#x27;tbody&#x27;,&#x27;td&#x27;,&#x27;tfoot&#x27;,&#x27;th&#x27;,&#x27;thead&#x27;,&#x27;tr&#x27;,&#x27;button&#x27;,&#x27;datalist&#x27;,&#x27;fieldset&#x27;,&#x27;form&#x27;,&#x27;input&#x27;,&#x27;label&#x27;,&#x27;legend&#x27;,&#x27;meter&#x27;,&#x27;optgroup&#x27;,&#x27;option&#x27;,&#x27;output&#x27;,&#x27;progress&#x27;,&#x27;select&#x27;,&#x27;textarea&#x27;];var notCss=knownTags.map(function(tag){return&#x27;:not( &#x27;+tag+&#x27; )&#x27;;}).join(&#x27;&#x27;);var nodes=document.querySelectorAll(&#x27;body &#x27;+notCss);var nodesArray=Array.prototype.slice.call(nodes);nodesArray.map(function(node){var outer=document.createElement(&#x27;div&#x27;);outer.className=&#x27;debug-wrapper&#x27;;var inner=document.createElement(&#x27;div&#x27;);inner.innerHTML=node.nodeName.toLowerCase();inner.className=&#x27;debug-component&#x27;;node.prepend(outer);outer.appendChild(inner);});var rules=[&#x27;\n  .debug-wrapper {\n      position: relative;\n  }&#x27;,&#x27;\n  .debug-component {\n      position: absolute;\n      right: 0;\n      z-index: 777;\n      color: lightgray;\n      font-size: 8px;\n  }&#x27;,&#x27;\n  .debug-component:hover {\n      color: black;\n      background-color: lightgray;\n      font-size: 12px;\n      padding: 0.2em;\n  }&#x27;];var sheet=window.document.styleSheets[0];rules.map(function(rule){return sheet.insertRule(rule,sheet.cssRules&amp;&amp;sheet.cssRules.length||0);});})();">Highlight custom components Bookmarklet (Drag and drop this to you bookmarks list)</a></p>

<p>Using the bookmarklet is remarkably easy, just drag and drop the link above to your browsers bookmarks list.</p>

<p>Next, navigate to a page with custom tags (An old Angular App for example) and press the bookmarklet while you are on the page.</p>

<p>For example try the <a href="https://material.angularjs.org/latest/">Angular material site</a></p>

<figure>
<img src="/2017/04/25/custom-component-highlight-bookmarklet/angular-material-component-highlight.gif" alt="Custom web components highlighted in Angular heroes example" />
<figcaption>Custom web components highlighted in Angular heroes example</figcaption>
</figure>

<h2 id="sources-and-further-reading">Sources and further reading</h2>

<ul>
  <li><a href="https://github.com/RRMoelker/component-highlight-bookmarklet">GitHub project</a>.</li>
  <li><a href="https://developer.mozilla.org/en-US/docs/Web/API/CSSStyleSheet/insertRule">CSS stylesheet manipulation</a></li>
  <li><a href="http://subsimple.com/bookmarklets/index.php">Comprehensive bookmarklet tutorial</a></li>
</ul>


  </div>

</article>

    </main>

    <footer class="site-footer" itemscope="" itemtype="http://schema.org/Corporation">
  <div class="container">
    <div class="footer-block"
        itemprop="address" 
        itemscope="" 
        itemtype="http://schema.org/PostalAddress">
      <h4 class="show-for-sr">Contact</h4>
      <a 
        href="https://www.google.com/maps/place/Kremerpad+11,+Hilversum,+Netherlands/@52.242604,5.1749074,17"
        title="Address in Google maps" 
        itemprop="address"
        itemscope=""
        itemtype="http://schema.org/PostalAddress">
        <span itemprop="name"><strong>DreamOnward</strong></span><br>
        <span itemprop="streetAddress">Kremerpad 11</span><br>
        <span itemprop="postalCode">1222 DB</span> <span itemprop="addressLocality">Hilversum</span>
      </a>
    </div>

    <div class="footer-block">
      <h4 class="show-for-sr">Media</h4>
      <ul class="social-media-list">
        
        <li>
          <a href="https://github.com/rrmoelker"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">rrmoelker</span></a>

        </li>
        

        
        <li>
          <a href="https://www.linkedin.com/company/dreamonward">
	<span class="icon"><svg viewBox="0 0 480 480"><path id="LinkedIn" d="M430.117,261.543V420.56h-92.188V272.193c0-37.271-13.334-62.707-46.703-62.707   c-25.473,0-40.632,17.142-47.301,33.724c-2.432,5.928-3.058,14.179-3.058,22.477V420.56h-92.219c0,0,1.242-251.285,0-277.32h92.21   v39.309c-0.187,0.294-0.43,0.611-0.606,0.896h0.606v-0.896c12.251-18.869,34.13-45.824,83.102-45.824   C384.633,136.724,430.117,176.361,430.117,261.543z M52.183,9.558C20.635,9.558,0,30.251,0,57.463   c0,26.619,20.038,47.94,50.959,47.94h0.616c32.159,0,52.159-21.317,52.159-47.94C103.128,30.251,83.734,9.558,52.183,9.558z    M5.477,420.56h92.184v-277.32H5.477V420.56z"/></svg></span><span class="username">dreamonward</span>
</a>

        </li>
        

        

        <li>
          <a href="mailto:info@dreamonward.com"><span class="icon"></span> info@dreamonward.com</a>
        </li>
      </ul>
    </div>


    <div class="footer-block contact" >
      <h4 class="show-for-sr">Info</h4>
      <span>KvK</span> <span>56017235</span><br>
      <span>General Terms and Conditions:
        <a href="/assets/terms/AV_DreamOnward_EN_2016-10-03.pdf">EN</a>
        <a href="/assets/terms/AV_DreamOnward_NL_2016-10-03.pdf">NL</a></span>
    </div>
  </div>


</footer>

  </body>

  <script src="/assets/vendor/lightbox/js/lightbox-plus-jquery.min.js"></script>
  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-83787018-1', 'auto');
  ga('send', 'pageview');

</script>

  <span>auto-deployed!</span>
</html>
